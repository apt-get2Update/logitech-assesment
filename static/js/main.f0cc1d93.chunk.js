(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{18:function(e,t,o){e.exports=o(30)},23:function(e,t,o){},30:function(e,t,o){"use strict";o.r(t);var a=o(0),r=o.n(a),n=o(14),s=o.n(n),c=(o(23),o(4)),i=o(5),l=o(8),d=o(6),u=o(9);var m=function(e){var t=e.row,o=e.index,a=e.books,n=e.zoom,s=e.type,c=a.reduce(function(e,t){return e<t.total?t.total:e},0),i=100*t.total/(c*n),l="bits"===s?"linear-gradient(to left, #314432 ".concat(i,"%, #1b262d 0%)"):"linear-gradient(to right, #402c33 ".concat(i,"%, #1b262d 0%)");return r.a.createElement("div",{className:"bits"===s?"flex-table":"flex-table reverse",style:{backgroundImage:l},key:"".concat(s,"-").concat(o).concat(t.amount).concat(t.count,"%").concat(t.price).concat(t.total)},r.a.createElement("div",{className:"flex-row"},t.count),r.a.createElement("div",{className:"flex-row"},Math.abs(parseFloat(t.amount)).toFixed(4)),r.a.createElement("div",{className:"flex-row"},parseFloat(t.total).toFixed(4)),r.a.createElement("div",{className:"flex-row"},t.price))};var p=function(e){return r.a.createElement("div",{className:"table-container"},r.a.createElement("div",{className:"flex-table header",role:"rowgroup"},r.a.createElement("div",{className:"flex-row"},"COUNT"),r.a.createElement("div",{className:"flex-row"},"AMOUNT"),r.a.createElement("div",{className:"flex-row"},"TOTAL"),r.a.createElement("div",{className:"flex-row"},"PRICE")),e.orderBookBids?e.orderBookBids.map(function(t,o){return r.a.createElement(m,{key:t.price,row:t,index:o,books:e.orderBookBids,zoom:e.zoom,type:"bits"})}):r.a.createElement("h2",null,"Loading..."))};var h=function(e){return r.a.createElement("div",{className:"table-container"},r.a.createElement("div",{className:"flex-table header",role:"rowgroup"},r.a.createElement("div",{className:"flex-row"},"PRICE"),r.a.createElement("div",{className:"flex-row"},"TOTAL"),r.a.createElement("div",{className:"flex-row"},"AMOUNT"),r.a.createElement("div",{className:"flex-row"},"COUNT")),e.orderBookAsks?e.orderBookAsks.map(function(t,o){return r.a.createElement(m,{key:t.price,row:t,index:o,books:e.orderBookAsks,zoom:e.zoom,type:"asks"})}):r.a.createElement("h2",null,"Loading..."))},f=o(7);var v=function(e,t){return{type:"UPDATE_BIDS_ORDER_BOOK",newBidsData:e,orderBy:t}};var b=function(e,t){return{type:"UPDATE_ASKS_ORDER_BOOK",newAsksData:e,orderBy:t}};var k=function(e){return{type:"CLEAR_ASKS",newAsksData:[]}};var B,O=function(e){return{type:"CLEAR_BIDS",newBidsData:[]}},E=o(3),w=function(e){function t(e){var o;return Object(c.a)(this,t),(o=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={connectionReady:!0,isConnected:!1,pres:0,volume24h:0,lastPrice:0,priceChange:0,zoom:1},o}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.subscribeToBtc()}},{key:"componentWillUnmount",value:function(){this.closeConnection()}},{key:"morePrecision",value:function(){this.closeConnection(),this.props.clearBidsOrderBook(),this.props.clearAsksOrderBook();var e=this.state.pres;this.setState({pres:e+1}),this.subscribeToBtc()}},{key:"lessPrecision",value:function(){this.closeConnection(),this.props.clearBidsOrderBook(),this.props.clearAsksOrderBook();var e=this.state.pres;this.setState({pres:e-1}),this.subscribeToBtc()}},{key:"subscribeToBtc",value:function(){var e=this;this.setState({isConnected:!0});(B=new WebSocket("wss://api-pub.bitfinex.com/ws/2")).onopen=function(){console.log("connected"),e.setState({connectionReady:!0}),B.send(JSON.stringify({event:"conf",flags:131072})),B.send(JSON.stringify({event:"subscribe",channel:"book",pair:"tBTCUSD",prec:"P"+e.state.pres,len:25}))},B.onmessage=function(t){!function(t){if(!t.event&&Array.isArray(t[1])&&3===t[1].length){var o={price:parseFloat(t[1][0]),count:t[1][1],amount:parseFloat(t[1][2]),total:parseFloat(0)};o.amount>0?e.props.updateBidsOrderBook(o,e.interFace.order):e.props.updateAsksOrderBook(o,e.interFace.order)}}(JSON.parse(t.data))},B.onclose=function(){console.log("disconnected")}}},{key:"closeConnection",value:function(){B.close(),this.setState({isConnected:!1})}},{key:"zoomOut",value:function(){this.setState({zoom:this.state.zoom-.2})}},{key:"zoomIn",value:function(){this.setState({zoom:this.state.zoom+.2})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("button",{disabled:this.state.zoom<.21,onClick:this.zoomOut.bind(this)},"Z-"),r.a.createElement("button",{disabled:1===this.state.zoom,onClick:this.zoomIn.bind(this)},"Z+"),r.a.createElement("button",{disabled:0===this.state.pres,onClick:this.lessPrecision.bind(this)},"P-"),r.a.createElement("button",{disabled:3===this.state.pres,onClick:this.morePrecision.bind(this)},"P+")),r.a.createElement("div",{className:"books-wrapper"},r.a.createElement("div",{className:"bids-container"},r.a.createElement(p,{orderBookBids:this.props.orderBookBids,zoom:this.state.zoom})),r.a.createElement("div",{className:"asks-container"},r.a.createElement(h,{orderBookAsks:this.props.orderBookAsks,zoom:this.state.zoom}))))}}]),t}(a.Component);var A=Object(f.b)(function(e){return{orderBookBids:e.orderBookBids,orderBookAsks:e.orderBookAsks,interFace:e.interFace}},function(e){return Object(E.a)({updateAsksOrderBook:b,updateBidsOrderBook:v,clearBidsOrderBook:O,clearAsksOrderBook:k},e)})(w),y=o(2),g=o(17),N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"price",r=!1;if(e.length>0&&e.forEach(function(o,a){o.price&&t.price&&o.price===t.price&&(r=!0,e[a].count=t.count,e[a].amount=t.amount)}),!0===r)return r=!1,e.slice();var n=Object(g.a)(e).concat([t]);return n.sort(function(e,t){return o?e[a]-t[a]:t[a]-e[a]}),n.length>25&&n.pop(),n.filter(function(e){return e&&0!==e.amount}).map(function(e,t){return n[t-1]&&n[t-1].total?Object(y.a)({},e,{total:parseFloat(n[t-1].total)+Math.abs(parseFloat(e.amount))}):Object(y.a)({},e,{total:parseFloat(e.amount)})})},S=Object(E.b)({orderBookBids:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,o=t.type,a=t.newBidsData,r=t.orderBy;switch(o){case"UPDATE_BIDS_ORDER_BOOK":return N(e,a,!1,r);case"CLEAR_BIDS":return a;default:return e.slice()}},orderBookAsks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,o=t.type,a=t.newAsksData,r=t.orderBy;switch(o){case"UPDATE_ASKS_ORDER_BOOK":return N(e,a,!0,r);case"CLEAR_ASKS":return a;default:return e.slice()}},interFace:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{format:"compact",visual:"default",order:"price"},t=arguments.length>1?arguments[1]:void 0,o=t.type,a=t.data;switch(o){case"UPDATE_ORDER":return Object(y.a)({},e,{order:a});case"UPDATE_VISUALIZATION":return Object(y.a)({},e,{visual:a});case"UPDATE_FORMAT":return Object(y.a)({},e,{format:a});default:return Object(y.a)({},e)}}}),D=function(){try{var e=localStorage.getItem("state");return e?JSON.parse(e):void 0}catch(t){return void console.error(t)}}(),x=Object(E.c)(S,D);x.subscribe(function(){!function(e){try{localStorage.setItem("state",JSON.stringify(e))}catch(t){console.error(t)}}(x.getState())});var C=x,T=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(f.a,{store:C},r.a.createElement("div",{className:"App"},r.a.createElement(A,null)))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(T,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[18,2,1]]]);
//# sourceMappingURL=main.f0cc1d93.chunk.js.map