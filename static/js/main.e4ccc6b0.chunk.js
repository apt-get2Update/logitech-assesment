(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{18:function(e,t,a){e.exports=a(30)},23:function(e,t,a){},30:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(14),i=a.n(r),c=(a(23),a(4)),s=a(5),l=a(8),u=a(6),d=a(9);var m=function(e){var t=e.row,a=e.index,n=e.books,r=e.zoom,i=e.type,c=e.visual,s=e.format,l=e.order,u=void 0===l?"count,price,amount,total":l,d="compact"===s?2:4,m="default"===c?"total":"amount",p=n.reduce(function(e,t){return e<t[m]?t[m]:e},0),h=100*t[m]/(p*r),f="bits"===i?"linear-gradient(to left, #314432 ".concat(h,"%, #1b262d 0%)"):"linear-gradient(to right, #402c33 ".concat(h,"%, #1b262d 0%)"),v=u.split(",");return o.a.createElement("div",{className:"bits"===i?"flex-table":"flex-table reverse",style:{backgroundImage:f},key:"".concat(i,"-").concat(a).concat(t.amount).concat(t.count,"%").concat(t.price).concat(t.total)},v.map(function(e){return o.a.createElement("div",{className:"flex-row"},"amount"===e||"total"===e?Math.abs(parseFloat(t[e])).toFixed(d):t[e])}))};function p(e){var t=e.order,a=e.className,n=t.split(",");return o.a.createElement("div",{className:a,role:"rowgroup"},n.map(function(e){return o.a.createElement("div",{className:"flex-row",key:e},e.toUpperCase())}))}var h=function(e){return o.a.createElement("div",{className:"table-container"},o.a.createElement(p,{order:e.order,className:"flex-table header"}),e.orderBookBids?e.orderBookBids.map(function(t,a){return o.a.createElement(m,{key:t.price,row:t,index:a,books:e.orderBookBids,zoom:e.zoom,type:"bits",visual:e.visual,format:e.format,order:e.order})}):o.a.createElement("h2",null,"Loading..."))};var f=function(e){return o.a.createElement("div",{className:"table-container"},o.a.createElement(p,{order:e.order,className:"flex-table header reverse"}),e.orderBookAsks?e.orderBookAsks.map(function(t,a){return o.a.createElement(m,{key:t.price,row:t,index:a,books:e.orderBookAsks,zoom:e.zoom,type:"asks",visual:e.visual,format:e.format,order:e.order})}):o.a.createElement("h2",null,"Loading..."))},v=a(7);var k=function(e){return{type:"UPDATE_BIDS_ORDER_BOOK",newBidsData:e}};var b=function(e){return{type:"UPDATE_ASKS_ORDER_BOOK",newAsksData:e}};var E=function(e){return{type:"CLEAR_ASKS",newAsksData:[]}};var B=function(e){return{type:"CLEAR_BIDS",newBidsData:[]}};function O(e){return{type:"UPDATE_ORDER",data:e}}function y(e){return{type:"UPDATE_VISUALIZATION",data:e}}function A(e){return{type:"UPDATE_FORMAT",data:e}}var g,w=a(3),S=function(e){var t=e.handleClose,a=e.show,n=e.children,r=a?"modal display-block":"modal display-none";return o.a.createElement("div",{className:r},o.a.createElement("section",{className:"modal-main"},o.a.createElement("div",{className:"modal-header"},o.a.createElement("header",null," Interface settings for order book"),o.a.createElement("button",{onClick:t},"X")),n))},C=["count,price,amount,total","count,amount,total,price","count,total,price,amount"],D=["compact","normal"],F=function(e){return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},N=function(e){var t=e.interFace,a=e.updateVisualization,n=e.updateOrder,r=e.updateFormat,i=t.order,c=t.format,s=t.visual;return o.a.createElement("div",null,o.a.createElement("section",null,o.a.createElement("header",null,"Book Depth Visualization:"),o.a.createElement("div",null,o.a.createElement("input",{type:"radio",id:"default",value:"default",checked:"default"===s,onChange:function(){return a("default")}}),"\xa0 ",o.a.createElement("label",{htmlFor:"default"},"Cumulative (default)"),o.a.createElement("br",null),o.a.createElement("input",{type:"radio",id:"amount",value:"amount",checked:"amount"===s,onChange:function(){return a("amount")}}),"\xa0 ",o.a.createElement("label",{htmlFor:"amount"},"Amount"))),o.a.createElement("section",null,o.a.createElement("header",null,"Choose the order of the columns in the order book:"),o.a.createElement("div",null,C.map(function(e){return o.a.createElement("div",{key:e},o.a.createElement("input",{type:"radio",id:e,value:e,checked:i===e,onChange:function(){return n(e)}}),"\xa0"," ",o.a.createElement("label",{htmlFor:e},e.split(",").map(F).join(" ")," ",o.a.createElement("b",null,e.split(",").map(F).reverse().join(" "))))}))),o.a.createElement("section",null,o.a.createElement("header",null,"Book Amount and Total format numbers:"),o.a.createElement("div",null,D.map(function(e){return o.a.createElement("div",{key:e},o.a.createElement("input",{type:"radio",id:e,value:e,checked:c===e,onChange:function(){return r(e)}}),"\xa0 ",o.a.createElement("label",{htmlFor:e},F(e)))}))))},j=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={connectionReady:!0,isConnected:!1,pres:0,volume24h:0,lastPrice:0,priceChange:0,zoom:1,show:!1},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.subscribeToBtc()}},{key:"componentWillUnmount",value:function(){this.closeConnection()}},{key:"morePrecision",value:function(){this.closeConnection(),this.props.clearBidsOrderBook(),this.props.clearAsksOrderBook();var e=this.state.pres;this.setState({pres:e+1}),this.subscribeToBtc()}},{key:"lessPrecision",value:function(){this.closeConnection(),this.props.clearBidsOrderBook(),this.props.clearAsksOrderBook();var e=this.state.pres;this.setState({pres:e-1}),this.subscribeToBtc()}},{key:"subscribeToBtc",value:function(){var e=this;this.setState({isConnected:!0});(g=new WebSocket("wss://api-pub.bitfinex.com/ws/2")).onopen=function(){console.log("connected"),e.setState({connectionReady:!0}),g.send(JSON.stringify({event:"conf",flags:131072})),g.send(JSON.stringify({event:"subscribe",channel:"book",pair:"tBTCUSD",prec:"P"+e.state.pres,len:25}))},g.onmessage=function(t){!function(t){if(!t.event&&Array.isArray(t[1])&&3===t[1].length){var a={price:parseFloat(t[1][0]),count:t[1][1],amount:parseFloat(t[1][2]),total:parseFloat(0)};a.amount>0?e.props.updateBidsOrderBook(a):e.props.updateAsksOrderBook(a)}}(JSON.parse(t.data))},g.onclose=function(){console.log("disconnected")}}},{key:"closeConnection",value:function(){g.close(),this.setState({isConnected:!1})}},{key:"zoomOut",value:function(){this.setState({zoom:this.state.zoom-.2})}},{key:"zoomIn",value:function(){this.setState({zoom:this.state.zoom+.2})}},{key:"handleModal",value:function(e){this.setState({show:e})}},{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement("div",{className:"main-header"},o.a.createElement("header",null,"ORDER BOOK BTC/USD"),o.a.createElement("div",null,o.a.createElement("button",{disabled:this.state.zoom<.21,onClick:this.zoomOut.bind(this)},"Z-"),o.a.createElement("button",{disabled:1===this.state.zoom,onClick:this.zoomIn.bind(this)},"Z+"),o.a.createElement("button",{onClick:function(){return e.handleModal(!0)}},"settings"),o.a.createElement("button",{disabled:0===this.state.pres,onClick:this.lessPrecision.bind(this)},"P-"),o.a.createElement("button",{disabled:3===this.state.pres,onClick:this.morePrecision.bind(this)},"P+"))),o.a.createElement("div",{className:"books-wrapper"},o.a.createElement("div",{className:"bids-container"},o.a.createElement(h,{orderBookBids:this.props.orderBookBids,zoom:this.state.zoom,visual:this.props.interFace.visual,format:this.props.interFace.format,order:this.props.interFace.order})),o.a.createElement("div",{className:"asks-container"},o.a.createElement(f,{orderBookAsks:this.props.orderBookAsks,zoom:this.state.zoom,visual:this.props.interFace.visual,format:this.props.interFace.format,order:this.props.interFace.order}))),o.a.createElement(S,{show:this.state.show,handleClose:function(){return e.handleModal(!1)}},o.a.createElement(N,this.props)))}}]),t}(n.Component);var z=Object(v.b)(function(e){return{orderBookBids:e.orderBookBids,orderBookAsks:e.orderBookAsks,interFace:e.interFace}},function(e){return Object(w.a)({updateAsksOrderBook:b,updateBidsOrderBook:k,clearBidsOrderBook:B,clearAsksOrderBook:E,updateFormat:A,updateVisualization:y,updateOrder:O},e)})(j),R=a(2),_=a(17),T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,n=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],!1);if(e.length>0&&e.forEach(function(a,o){a.price&&t.price&&a.price===t.price&&(n=!0,e[o].count=t.count,e[o].amount=t.amount)}),!0===n)return n=!1,e.slice();var o=Object(_.a)(e).concat([t]);return o.sort(function(e,t){return a?e.price-t.price:t.price-e.price}),o.length>25&&o.pop(),o.filter(function(e){return e&&0!==e.amount}).map(function(e,t){return o[t-1]&&o[t-1].total?Object(R.a)({},e,{total:parseFloat(o[t-1].total)+Math.abs(parseFloat(e.amount))}):Object(R.a)({},e,{total:parseFloat(e.amount)})})},P=Object(w.b)({orderBookBids:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.newBidsData;switch(a){case"UPDATE_BIDS_ORDER_BOOK":return T(e,n,!1);case"CLEAR_BIDS":return n;default:return e.slice()}},orderBookAsks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.newAsksData;switch(a){case"UPDATE_ASKS_ORDER_BOOK":return T(e,n,!0);case"CLEAR_ASKS":return n;default:return e.slice()}},interFace:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{format:"compact",visual:"default",order:"count,price,amount,total"},t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.data;switch(a){case"UPDATE_ORDER":return Object(R.a)({},e,{order:n});case"UPDATE_VISUALIZATION":return Object(R.a)({},e,{visual:n});case"UPDATE_FORMAT":return Object(R.a)({},e,{format:n});default:return Object(R.a)({},e)}}}),I=function(){try{var e=localStorage.getItem("state");return e?JSON.parse(e):void 0}catch(t){return void console.error(t)}}(),U=Object(w.c)(P,I);U.subscribe(function(){!function(e){try{localStorage.setItem("state",JSON.stringify(e))}catch(t){console.error(t)}}(U.getState())});var x=U,K=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return o.a.createElement(v.a,{store:x},o.a.createElement("div",{className:"App"},o.a.createElement(z,null)))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(K,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[18,2,1]]]);
//# sourceMappingURL=main.e4ccc6b0.chunk.js.map