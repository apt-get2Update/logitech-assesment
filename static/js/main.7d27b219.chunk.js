(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{18:function(e,t,o){e.exports=o(30)},23:function(e,t,o){},30:function(e,t,o){"use strict";o.r(t);var a=o(0),n=o.n(a),r=o(14),s=o.n(r),c=(o(23),o(3)),i=o(4),l=o(7),d=o(5),u=o(8);var m=function(e){var t=e.row,o=e.index,a=e.books,r=e.zoom,s=e.type,c=a.reduce(function(e,t){return e<t.total?t.total:e},0),i=100*t.total/(c*r),l="bits"===s?"linear-gradient(to left, #314432 ".concat(i,"%, #1b262d 0%)"):"linear-gradient(to right, #402c33 ".concat(i,"%, #1b262d 0%)");return n.a.createElement("div",{className:"bits"===s?"flex-table":"flex-table reverse",style:{backgroundImage:l},key:"".concat(s,"-").concat(o).concat(t.amount).concat(t.count,"%").concat(t.price).concat(t.total)},n.a.createElement("div",{className:"flex-row"},t.count),n.a.createElement("div",{className:"flex-row"},Math.abs(parseFloat(t.amount)).toFixed(4)),n.a.createElement("div",{className:"flex-row"},parseFloat(t.total).toFixed(4)),n.a.createElement("div",{className:"flex-row"},t.price))};var p=function(e){return n.a.createElement("div",{className:"table-container"},n.a.createElement("div",{className:"flex-table header",role:"rowgroup"},n.a.createElement("div",{className:"flex-row"},"COUNT"),n.a.createElement("div",{className:"flex-row"},"AMOUNT"),n.a.createElement("div",{className:"flex-row"},"TOTAL"),n.a.createElement("div",{className:"flex-row"},"PRICE")),e.orderBookBids?e.orderBookBids.map(function(t,o){return n.a.createElement(m,{key:t.price,row:t,index:o,books:e.orderBookBids,zoom:e.zoom,type:"bits"})}):n.a.createElement("h2",null,"Loading..."))};var h=function(e){return n.a.createElement("div",{className:"table-container"},n.a.createElement("div",{className:"flex-table header",role:"rowgroup"},n.a.createElement("div",{className:"flex-row"},"PRICE"),n.a.createElement("div",{className:"flex-row"},"TOTAL"),n.a.createElement("div",{className:"flex-row"},"AMOUNT"),n.a.createElement("div",{className:"flex-row"},"COUNT")),e.orderBookAsks?e.orderBookAsks.map(function(t,o){return n.a.createElement(m,{key:t.price,row:t,index:o,books:e.orderBookAsks,zoom:e.zoom,type:"asks"})}):n.a.createElement("h2",null,"Loading..."))},v=o(6);var f=function(e){return{type:"UPDATE_BIDS_ORDER_BOOK",newBidsData:e}};var k=function(e){return{type:"UPDATE_ASKS_ORDER_BOOK",newAsksData:e}};var b=function(e){return{type:"CLEAR_ASKS",newAsksData:[]}};var B,E=function(e){return{type:"CLEAR_BIDS",newBidsData:[]}},O=o(2),w=function(e){function t(e){var o;return Object(c.a)(this,t),(o=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={connectionReady:!0,isConnected:!1,pres:0,volume24h:0,lastPrice:0,priceChange:0,zoom:1},o}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.subscribeToBtc()}},{key:"componentWillUnmount",value:function(){this.closeConnection()}},{key:"morePrecision",value:function(){this.closeConnection(),this.props.clearBidsOrderBook(),this.props.clearAsksOrderBook();var e=this.state.pres;this.setState({pres:e+1}),this.subscribeToBtc()}},{key:"lessPrecision",value:function(){this.closeConnection(),this.props.clearBidsOrderBook(),this.props.clearAsksOrderBook();var e=this.state.pres;this.setState({pres:e-1}),this.subscribeToBtc()}},{key:"subscribeToBtc",value:function(){var e=this;this.setState({isConnected:!0});(B=new WebSocket("wss://api-pub.bitfinex.com/ws/2")).onopen=function(){console.log("connected"),e.setState({connectionReady:!0}),B.send(JSON.stringify({event:"conf",flags:131072})),B.send(JSON.stringify({event:"subscribe",channel:"book",pair:"tBTCUSD",prec:"P"+e.state.pres,len:25}))},B.onmessage=function(t){!function(t){if(!t.event&&Array.isArray(t[1])&&3===t[1].length){var o={price:parseFloat(t[1][0]),count:t[1][1],amount:parseFloat(t[1][2]),total:parseFloat(0)};o.amount>0?e.props.updateBidsOrderBook(o):e.props.updateAsksOrderBook(o)}}(JSON.parse(t.data))},B.onclose=function(){console.log("disconnected")}}},{key:"closeConnection",value:function(){B.close(),this.setState({isConnected:!1})}},{key:"zoomOut",value:function(){this.setState({zoom:this.state.zoom-.2})}},{key:"zoomIn",value:function(){this.setState({zoom:this.state.zoom+.2})}},{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement("div",null,n.a.createElement("button",{disabled:this.state.zoom<.21,onClick:this.zoomOut.bind(this)},"Z-"),n.a.createElement("button",{disabled:1===this.state.zoom,onClick:this.zoomIn.bind(this)},"Z+"),n.a.createElement("button",{disabled:0===this.state.pres,onClick:this.lessPrecision.bind(this)},"P-"),n.a.createElement("button",{disabled:3===this.state.pres,onClick:this.morePrecision.bind(this)},"P+")),n.a.createElement("div",{className:"books-wrapper"},n.a.createElement("div",{className:"bids-container"},n.a.createElement(p,{orderBookBids:this.props.orderBookBids,zoom:this.state.zoom})),n.a.createElement("div",{className:"asks-container"},n.a.createElement(h,{orderBookAsks:this.props.orderBookAsks,zoom:this.state.zoom}))))}}]),t}(a.Component);var g=Object(v.b)(function(e){return{orderBookBids:e.orderBookBids,orderBookAsks:e.orderBookAsks,tradesList:e.tradesList}},function(e){return Object(O.a)({updateAsksOrderBook:k,updateBidsOrderBook:f,clearBidsOrderBook:E,clearAsksOrderBook:b},e)})(w),A=o(12),y=o(17),N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"price",n=!1;if(e.length>0&&e.forEach(function(o,a){o.price&&t.price&&o.price===t.price&&(n=!0,e[a].count=t.count,e[a].amount=t.amount)}),!0===n)return n=!1,e.slice();var r=Object(y.a)(e).concat([t]);return r.sort(function(e,t){return o?e[a]-t[a]:t[a]-e[a]}),r.length>25&&r.pop(),r.filter(function(e){return e&&0!==e.amount}).map(function(e,t){return r[t-1]&&r[t-1].total?Object(A.a)({},e,{total:parseFloat(r[t-1].total)+Math.abs(parseFloat(e.amount))}):Object(A.a)({},e,{total:parseFloat(e.amount)})})},S=Object(O.b)({orderBookBids:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_BIDS_ORDER_BOOK":var o=t.newBidsData;return N(e,o,!1);case"CLEAR_BIDS":return t.newBidsData;default:return e.slice()}},orderBookAsks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_ASKS_ORDER_BOOK":var o=t.newAsksData;return N(e,o,!0);case"CLEAR_ASKS":return t.newAsksData;default:return e.slice()}}}),x=function(){try{var e=localStorage.getItem("state");return e?JSON.parse(e):void 0}catch(t){return void console.error(t)}}(),C=Object(O.c)(S,x);C.subscribe(function(){!function(e){try{localStorage.setItem("state",JSON.stringify(e))}catch(t){console.error(t)}}(C.getState())});var D=C,z=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return n.a.createElement(v.a,{store:D},n.a.createElement("div",{className:"App"},n.a.createElement(g,null)))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(n.a.createElement(z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[18,2,1]]]);
//# sourceMappingURL=main.7d27b219.chunk.js.map